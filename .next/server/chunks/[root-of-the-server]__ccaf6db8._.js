module.exports=[54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},51615,(e,t,r)=>{t.exports=e.x("node:buffer",()=>require("node:buffer"))},66680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},12057,(e,t,r)=>{t.exports=e.x("node:util",()=>require("node:util"))},36296,e=>{"use strict";let t,r,i;var a,n,o,s,c,p,l=e.i(54799);"function"!=typeof l.hkdf||process.versions.electron||(t=async(...e)=>new Promise((t,r)=>{l.hkdf(...e,(e,i)=>{e?r(e):t(new Uint8Array(i))})}));let u=async(e,r,i,a,n)=>(t||((e,t,r,i,a)=>{let n=parseInt(e.substr(3),10)>>3||20,o=(0,l.createHmac)(e,r.byteLength?r:new Uint8Array(n)).update(t).digest(),s=Math.ceil(a/n),c=new Uint8Array(n*s+i.byteLength+1),p=0,u=0;for(let t=1;t<=s;t++)c.set(i,u),c[u+i.byteLength]=t,c.set((0,l.createHmac)(e,o).update(c.subarray(p,u+i.byteLength+1)).digest(),u),p=u,u+=n;return c.slice(0,a)}))(e,r,i,a,n);function h(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function y(e,t,r,i,a){return u(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=h(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),h(r,"salt"),function(e){let t=h(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(i),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(a,e))}var d=e.i(51615),f=e.i(66680);let m=(e,t)=>(0,f.createHash)(e).update(t).digest(),w=new TextEncoder,E=new TextDecoder;function g(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}function b(e,t,r){if(t<0||t>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function A(e){let t=new Uint8Array(4);return b(t,e),t}function v(e){return g(A(e.length),e)}async function S(e,t,r){let i=Math.ceil((t>>3)/32),a=new Uint8Array(32*i);for(let t=0;t<i;t++){let i=new Uint8Array(4+e.length+r.length);i.set(A(t+1)),i.set(e,4),i.set(r,4+e.length),a.set(await m("sha256",i),32*t)}return a.slice(0,t>>3)}let k=e=>d.Buffer.from(e).toString("base64url"),C=e=>{let t;return new Uint8Array(d.Buffer.from(((t=e)instanceof Uint8Array&&(t=E.decode(t)),t),"base64url"))};Symbol();class K extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class T extends K{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class O extends K{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class P extends K{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class x extends K{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class W extends K{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(e="decryption operation failed",t){super(e,t)}}class J extends K{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class _ extends K{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class R extends K{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class I extends K{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}var $=f,H=e.i(12057);let j=f.webcrypto;function M(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function D(e,t){return e.name===t}function U(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!D(e.algorithm,"AES-GCM"))throw M("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw M(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!D(e.algorithm,"AES-KW"))throw M("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw M(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw M("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!D(e.algorithm,"PBKDF2"))throw M("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!D(e.algorithm,"RSA-OAEP"))throw M("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw M(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}if(r.length&&!r.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(r.length>2){let t=r.pop();e+=`one of ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of ${r[0]} or ${r[1]}.`:e+=`${r[0]}.`;throw TypeError(e)}}function L(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let B=(e,...t)=>L("Key must be ",e,...t);function N(e,t,...r){return L(`Key for the ${e} algorithm must be `,t,...r)}let G=e=>(r||=new Set((0,f.getCiphers)())).has(e),z=e=>H.types.isKeyObject(e)||H.types.isCryptoKey(e),F=["KeyObject"];(globalThis.CryptoKey||j?.CryptoKey)&&F.push("CryptoKey");let V=(e,t,r)=>{let i=parseInt(e.slice(1,4),10),a=`aes${i}-wrap`;if(!G(a))throw new x(`alg ${e} is not supported either by JOSE or your javascript runtime`);let n=function(e,t,r){if(H.types.isKeyObject(e))return e;if(e instanceof Uint8Array)return(0,f.createSecretKey)(e);if(H.types.isCryptoKey(e))return U(e,t,r),f.KeyObject.from(e);throw TypeError(B(e,...F,"Uint8Array"))}(t,e,"unwrapKey");if(n.symmetricKeySize<<3!==parseInt(e.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${e}`);let o=(0,f.createDecipheriv)(a,n,d.Buffer.alloc(8,166));return g(o.update(r),o.final())};function X(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function q(e){return X(e)&&"string"==typeof e.kty}async function Y(e,t,r,i,a=new Uint8Array(0),n=new Uint8Array(0)){let o,s;if(H.types.isCryptoKey(e))U(e,"ECDH"),o=f.KeyObject.from(e);else if(H.types.isKeyObject(e))o=e;else throw TypeError(B(e,...F));if(H.types.isCryptoKey(t))U(t,"ECDH","deriveBits"),s=f.KeyObject.from(t);else if(H.types.isKeyObject(t))s=t;else throw TypeError(B(t,...F));let c=g(v(w.encode(r)),v(a),v(n),A(i));return S((0,f.diffieHellman)({privateKey:s,publicKey:o}),i,c)}new WeakMap,(0,H.promisify)(f.generateKeyPair);var $=f;let Z=(0,H.promisify)(f.pbkdf2),Q=async(e,t,r,i,a)=>{if(!(a instanceof Uint8Array)||a.length<8)throw new J("PBES2 Salt Input must be 8 or more octets");let n=g(w.encode(e),new Uint8Array([0]),a),o=parseInt(e.slice(13,16),10)>>3,s=function(e,t){if(H.types.isKeyObject(e))return e.export();if(e instanceof Uint8Array)return e;if(H.types.isCryptoKey(e))return U(e,t,"deriveBits","deriveKey"),f.KeyObject.from(e).export();throw TypeError(B(e,...F,"Uint8Array"))}(t,e),c=await Z(s,n,i,o,`sha${e.slice(8,11)}`);return V(e.slice(-6),c,r)},ee=(0,H.deprecate)(()=>f.constants.RSA_PKCS1_PADDING,'The RSA1_5 "alg" (JWE Algorithm) is deprecated and will be removed in the next major revision.'),et={};var $=f;function er(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new x(`Unsupported JWE Algorithm: ${e}`)}}let ei=e=>e?.[Symbol.toStringTag],ea=(e,t,r)=>{if(void 0!==t.use&&"sig"!==t.use)throw TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&t.key_ops.includes?.(r)!==!0)throw TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(void 0!==t.alg&&t.alg!==e)throw TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0};function en(e,t,r,i){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?((e,t,r,i)=>{if(!(t instanceof Uint8Array)){if(i&&q(t)){if(q(t)&&"oct"===t.kty&&"string"==typeof t.k&&ea(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!z(t))throw TypeError(N(e,t,...F,"Uint8Array",i?"JSON Web Key":null));if("secret"!==t.type)throw TypeError(`${ei(t)} instances for symmetric algorithms must be of type "secret"`)}})(t,r,i,e):((e,t,r,i)=>{if(i&&q(t))switch(r){case"sign":if("oct"!==t.kty&&"string"==typeof t.d&&ea(e,t,r))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"verify":if("oct"!==t.kty&&void 0===t.d&&ea(e,t,r))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!z(t))throw TypeError(N(e,t,...F,i?"JSON Web Key":null));if("secret"===t.type)throw TypeError(`${ei(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${ei(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${ei(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${ei(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${ei(t)} instances for asymmetric algorithm encryption must be of type "public"`)})(t,r,i,e)}let eo=en.bind(void 0,!1);en.bind(void 0,!0);let es=f.timingSafeEqual,ec=(e,t,r,i,a,n)=>{let o;if(H.types.isCryptoKey(t))U(t,e,"decrypt"),o=f.KeyObject.from(t);else if(t instanceof Uint8Array||H.types.isKeyObject(t))o=t;else throw TypeError(B(t,...F,"Uint8Array"));if(!i)throw new J("JWE Initialization Vector missing");if(!a)throw new J("JWE Authentication Tag missing");((e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new x(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new J(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if(H.types.isKeyObject(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new J(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")})(e,o);if(i.length<<3!==function(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new x(`Unsupported JWE Algorithm: ${e}`)}}(e))throw new J("Invalid Initialization Vector length");switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,i,a,n){var o;let s,c,p,l,u,h,y,d=parseInt(e.slice(1,4),10);p=t,H.types.isKeyObject(p)&&(t=t.export());let m=t.subarray(d>>3),w=t.subarray(0,d>>3),E=parseInt(e.slice(-3),10),A=`aes-${d}-cbc`;if(!G(A))throw new x(`alg ${e} is not supported by your javascript runtime`);let v=(h=g(n,i,r,(l=Math.floor((o=n.length<<3)/0x100000000),b(u=new Uint8Array(8),l,0),b(u,o%0x100000000,4),u)),(y=(0,f.createHmac)(`sha${E}`,w)).update(h),y.digest().slice(0,d>>3));try{s=es(a,v)}catch{}if(!s)throw new W;try{let e=(0,f.createDecipheriv)(A,m,i);c=g(e.update(r),e.final())}catch{}if(!c)throw new W;return c}(e,o,r,i,a,n);case"A128GCM":case"A192GCM":case"A256GCM":var s=o;let c=parseInt(e.slice(1,4),10),p=`aes-${c}-gcm`;if(!G(p))throw new x(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,f.createDecipheriv)(p,s,i,{authTagLength:16});e.setAuthTag(a),n.byteLength&&e.setAAD(n,{plaintextLength:r.length});let t=e.update(r);return e.final(),t}catch{throw new W}default:throw new x("Unsupported JWE Content Encryption Algorithm")}};async function ep(e,t,r,i,a){return ec(e.slice(0,7),t,r,i,a,new Uint8Array(0))}let el=function(e,t,r,i,a){let n;if(void 0!==a.crit&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(n=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!n.has(o))throw new x(`Extension Header Parameter "${o}" is not recognized`);if(void 0===a[o])throw new e(`Extension Header Parameter "${o}" is missing`);if(n.get(o)&&void 0===i[o])throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(i.crit)},eu=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,eh=e=>{let t,r=eu.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let i=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(i);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*i);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*i);break;case"day":case"days":case"d":t=Math.round(86400*i);break;case"week":case"weeks":case"w":t=Math.round(604800*i);break;default:t=Math.round(0x1e187e0*i)}return"-"===r[1]||"ago"===r[4]?-t:t};e.s(["decode",0,C,"encode",0,k],88201);var ey=e.i(88201),ey=ey;let ed=(e,t)=>{if("string"!=typeof e||!e)throw new R(`${t} missing or invalid`)};async function ef(e,t){let r;if(!X(e))throw TypeError("JWK must be an object");if("sha256"!==(t??="sha256")&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":ed(e.crv,'"crv" (Curve) Parameter'),ed(e.x,'"x" (X Coordinate) Parameter'),ed(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":ed(e.crv,'"crv" (Subtype of Key Pair) Parameter'),ed(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":ed(e.e,'"e" (Exponent) Parameter'),ed(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":ed(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new x('"kty" (Key Type) Parameter missing or unsupported')}let i=w.encode(JSON.stringify(r));return k(await m(t,i))}async function em(e,t){if(!X(e))throw TypeError("JWK must be an object");switch(t||=e.alg,e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return C(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new x('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":var r;return(r={...e,alg:t}).d?(0,f.createPrivateKey)({format:"jwk",key:r}):(0,f.createPublicKey)({format:"jwk",key:r});default:throw new x('Unsupported "kty" (Key Type) Parameter value')}}async function ew(e,t,r,i,a){switch(eo(e,t,"decrypt"),t=await et.normalizePrivateKey?.(t,e)||t,e){case"dir":if(void 0!==r)throw new J("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new J("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let a,n;if(!X(i.epk))throw new J('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!["P-256","P-384","P-521","X25519","X448"].includes(((e,t)=>{let r;if(H.types.isCryptoKey(e))r=f.KeyObject.from(e);else if(H.types.isKeyObject(e))r=e;else if(q(e))return e.crv;else throw TypeError(B(e,...F));if("secret"===r.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(r.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${r.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${r.asymmetricKeyType.slice(1)}`;case"ec":{let e=r.asymmetricKeyDetails.namedCurve;!1;switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new x("Unsupported key curve for this operation")}}default:throw TypeError("Invalid asymmetric key type for this operation")}})(t)))throw new x("ECDH with the provided key is not allowed or not supported by your javascript runtime");let o=await em(i.epk,e);if(void 0!==i.apu){if("string"!=typeof i.apu)throw new J('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{a=C(i.apu)}catch{throw new J("Failed to base64url decode the apu")}}if(void 0!==i.apv){if("string"!=typeof i.apv)throw new J('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{n=C(i.apv)}catch{throw new J("Failed to base64url decode the apv")}}let s=await Y(o,t,"ECDH-ES"===e?i.enc:e,"ECDH-ES"===e?er(i.enc):parseInt(e.slice(-5,-2),10),a,n);if("ECDH-ES"===e)return s;if(void 0===r)throw new J("JWE Encrypted Key missing");return V(e.slice(-6),s,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new J("JWE Encrypted Key missing");var n=e,o=t,s=r;let c,p=(e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return f.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return ee();default:return}})(n),l=(e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}})(n),u=function(e,t,...r){if(H.types.isKeyObject(e))return e;if(H.types.isCryptoKey(e))return U(e,t,...r),f.KeyObject.from(e);throw TypeError(B(e,...F))}(o,n,"unwrapKey","decrypt");if("rsa"!==u.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");try{c=u instanceof f.KeyObject?u.asymmetricKeyDetails?.modulusLength:Buffer.from(u.n,"base64url").byteLength<<3}catch{}if("number"!=typeof c||c<2048)throw TypeError(`${n} requires key modulusLength to be 2048 bits or larger`);return(0,f.privateDecrypt)({key:u,oaepHash:l,padding:p},s);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let n;if(void 0===r)throw new J("JWE Encrypted Key missing");if("number"!=typeof i.p2c)throw new J('JOSE Header "p2c" (PBES2 Count) missing or invalid');let o=a?.maxPBES2Count||1e4;if(i.p2c>o)throw new J('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof i.p2s)throw new J('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{n=C(i.p2s)}catch{throw new J("Failed to base64url decode the p2s")}return Q(e,t,r,i.p2c,n)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new J("JWE Encrypted Key missing");return V(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let a,n;if(void 0===r)throw new J("JWE Encrypted Key missing");if("string"!=typeof i.iv)throw new J('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof i.tag)throw new J('JOSE Header "tag" (Authentication Tag) missing or invalid');try{a=C(i.iv)}catch{throw new J("Failed to base64url decode the iv")}try{n=C(i.tag)}catch{throw new J("Failed to base64url decode the tag")}return ep(e,t,r,a,n)}default:throw new x('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let eE=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function eg(e,t,r){let i,a,n,o,s,c,p;if(!X(e))throw new J("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new J("JOSE Header missing");if(void 0!==e.iv&&"string"!=typeof e.iv)throw new J("JWE Initialization Vector incorrect type");if("string"!=typeof e.ciphertext)throw new J("JWE Ciphertext missing or incorrect type");if(void 0!==e.tag&&"string"!=typeof e.tag)throw new J("JWE Authentication Tag incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new J("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new J("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new J("JWE AAD incorrect type");if(void 0!==e.header&&!X(e.header))throw new J("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!X(e.unprotected))throw new J("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=C(e.protected);i=JSON.parse(E.decode(t))}catch{throw new J("JWE Protected Header is invalid")}if(!((...e)=>{let t,r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0})(i,e.header,e.unprotected))throw new J("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let l={...i,...e.header,...e.unprotected};if(el(J,new Map,r?.crit,i,l),void 0!==l.zip)throw new x('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:u,enc:h}=l;if("string"!=typeof u||!u)throw new J("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new J("missing JWE Encryption Algorithm (enc) in JWE Header");let y=r&&eE("keyManagementAlgorithms",r.keyManagementAlgorithms),d=r&&eE("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(y&&!y.has(u)||!y&&u.startsWith("PBES2"))throw new P('"alg" (Algorithm) Header Parameter value not allowed');if(d&&!d.has(h))throw new P('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==e.encrypted_key)try{a=C(e.encrypted_key)}catch{throw new J("Failed to base64url decode the encrypted_key")}let f=!1;"function"==typeof t&&(t=await t(i,e),f=!0);try{n=await ew(u,t,a,l,r)}catch(e){if(e instanceof TypeError||e instanceof J||e instanceof x)throw e;n=(0,$.randomFillSync)(new Uint8Array(er(h)>>3))}if(void 0!==e.iv)try{o=C(e.iv)}catch{throw new J("Failed to base64url decode the iv")}if(void 0!==e.tag)try{s=C(e.tag)}catch{throw new J("Failed to base64url decode the tag")}let m=w.encode(e.protected??"");c=void 0!==e.aad?g(m,w.encode("."),w.encode(e.aad)):m;try{p=C(e.ciphertext)}catch{throw new J("Failed to base64url decode the ciphertext")}let b={plaintext:await ec(h,n,p,o,s,c)};if(void 0!==e.protected&&(b.protectedHeader=i),void 0!==e.aad)try{b.additionalAuthenticatedData=C(e.aad)}catch{throw new J("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(b.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(b.unprotectedHeader=e.header),f)?{...b,key:t}:b}async function eb(e,t,r){if(e instanceof Uint8Array&&(e=E.decode(e)),"string"!=typeof e)throw new J("Compact JWE must be a string or Uint8Array");let{0:i,1:a,2:n,3:o,4:s,length:c}=e.split(".");if(5!==c)throw new J("Invalid Compact JWE");let p=await eg({ciphertext:o,iv:n||void 0,protected:i,tag:s||void 0,encrypted_key:a||void 0},t,r),l={plaintext:p.plaintext,protectedHeader:p.protectedHeader};return"function"==typeof t?{...l,key:p.key}:l}let eA=e=>e.toLowerCase().replace(/^application\//,"");async function ev(e,t,r){let i=await eb(e,t,r),a=((e,t,r={})=>{var i,a;let n,o;try{n=JSON.parse(E.decode(t))}catch{}if(!X(n))throw new _("JWT Claims Set must be a top-level JSON object");let{typ:s}=r;if(s&&("string"!=typeof e.typ||eA(e.typ)!==eA(s)))throw new T('unexpected "typ" JWT header value',n,"typ","check_failed");let{requiredClaims:c=[],issuer:p,subject:l,audience:u,maxTokenAge:h}=r,y=[...c];for(let e of(void 0!==h&&y.push("iat"),void 0!==u&&y.push("aud"),void 0!==l&&y.push("sub"),void 0!==p&&y.push("iss"),new Set(y.reverse())))if(!(e in n))throw new T(`missing required "${e}" claim`,n,e,"missing");if(p&&!(Array.isArray(p)?p:[p]).includes(n.iss))throw new T('unexpected "iss" claim value',n,"iss","check_failed");if(l&&n.sub!==l)throw new T('unexpected "sub" claim value',n,"sub","check_failed");if(u&&(i=n.aud,a="string"==typeof u?[u]:u,"string"==typeof i?!a.includes(i):!(Array.isArray(i)&&a.some(Set.prototype.has.bind(new Set(i))))))throw new T('unexpected "aud" claim value',n,"aud","check_failed");switch(typeof r.clockTolerance){case"string":o=eh(r.clockTolerance);break;case"number":o=r.clockTolerance;break;case"undefined":o=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:d}=r,f=Math.floor((d||new Date).getTime()/1e3);if((void 0!==n.iat||h)&&"number"!=typeof n.iat)throw new T('"iat" claim must be a number',n,"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new T('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>f+o)throw new T('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new T('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=f-o)throw new O('"exp" claim timestamp check failed',n,"exp","check_failed")}if(h){let e=f-n.iat;if(e-o>("number"==typeof h?h:eh(h)))throw new O('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(e<0-o)throw new T('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n})(i.protectedHeader,i.plaintext,r),{protectedHeader:n}=i;if(void 0!==n.iss&&n.iss!==a.iss)throw new T('replicated "iss" claim header parameter mismatch',a,"iss","mismatch");if(void 0!==n.sub&&n.sub!==a.sub)throw new T('replicated "sub" claim header parameter mismatch',a,"sub","mismatch");if(void 0!==n.aud&&JSON.stringify(n.aud)!==JSON.stringify(a.aud))throw new T('replicated "aud" claim header parameter mismatch',a,"aud","mismatch");let o={payload:a,protectedHeader:n};return"function"==typeof t?{...o,key:i.key}:o}var eS=function(e,t,r,i,a){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,r):a?a.value=r:t.set(e,r),r},ek=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};class eC{constructor(e,t,r){if(a.add(this),n.set(this,{}),o.set(this,void 0),s.set(this,void 0),eS(this,s,r,"f"),eS(this,o,e,"f"),!t)return;const{name:i}=e;for(const[e,r]of Object.entries(t))e.startsWith(i)&&r&&(ek(this,n,"f")[e]=r)}get value(){return Object.keys(ek(this,n,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>ek(this,n,"f")[e]).join("")}chunk(e,t){let r=ek(this,a,"m",p).call(this);for(let i of ek(this,a,"m",c).call(this,{name:ek(this,o,"f").name,value:e,options:{...ek(this,o,"f").options,...t}}))r[i.name]=i;return Object.values(r)}clean(){return Object.values(ek(this,a,"m",p).call(this))}}n=new WeakMap,o=new WeakMap,s=new WeakMap,a=new WeakSet,c=function(e){let t=Math.ceil(e.value.length/3936);if(1===t)return ek(this,n,"f")[e.name]=e.value,[e];let r=[];for(let i=0;i<t;i++){let t=`${e.name}.${i}`,a=e.value.substr(3936*i,3936);r.push({...e,name:t,value:a}),ek(this,n,"f")[t]=a}return ek(this,s,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(e=>e.value.length+160)}),r},p=function(){let e={};for(let t in ek(this,n,"f"))delete ek(this,n,"f")?.[t],e[t]={name:t,value:"",options:{...ek(this,o,"f").options,maxAge:0}};return e};class eK extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);const r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class eT extends eK{}eT.type="MissingSecret";let eO=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,eP=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,ex=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,eW=/^[\u0020-\u003A\u003D-\u007E]*$/,eJ=Object.prototype.toString,e_=((i=function(){}).prototype=Object.create(null),i);function eR(e,t){let r=new e_,i=e.length;if(i<2)return r;let a=t?.decode||ej,n=0;do{let t=e.indexOf("=",n);if(-1===t)break;let o=e.indexOf(";",n),s=-1===o?i:o;if(t>s){n=e.lastIndexOf(";",t-1)+1;continue}let c=eI(e,n,t),p=e$(e,t,c),l=e.slice(c,p);if(void 0===r[l]){let i=eI(e,t+1,s),n=e$(e,s,i),o=a(e.slice(i,n));r[l]=o}n=s+1}while(n<i)return r}function eI(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r)return r}function e$(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function eH(e,t,r){let i=r?.encode||encodeURIComponent;if(!eO.test(e))throw TypeError(`argument name is invalid: ${e}`);let a=i(t);if(!eP.test(a))throw TypeError(`argument val is invalid: ${t}`);let n=e+"="+a;if(!r)return n;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);n+="; Max-Age="+r.maxAge}if(r.domain){if(!ex.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);n+="; Domain="+r.domain}if(r.path){if(!eW.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);n+="; Path="+r.path}if(r.expires){var o;if(o=r.expires,"[object Date]"!==eJ.call(o)||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);n+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.partitioned&&(n+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":n+="; Priority=Low";break;case"medium":n+="; Priority=Medium";break;case"high":n+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"none":n+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return n}function ej(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}e.s(["parse",()=>eR,"serialize",()=>eH],26280);let{parse:eM}=e.i(26280);async function eD(e){let{token:t,secret:r,salt:i}=e,a=Array.isArray(r)?r:[r];if(!t)return null;let{payload:n}=await ev(t,async({kid:e,enc:t})=>{for(let r of a){let a=await eL(t,r,i);if(void 0===e||e===await ef({kty:"oct",k:ey.encode(a)},`sha${a.byteLength<<3}`))return a}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:["A256CBC-HS512","A256GCM"]});return n}async function eU(e){var t;let r,{secureCookie:i,cookieName:a=(r=(t=i??!1)?"__Secure-":"",{sessionToken:{name:`${r}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},callbackUrl:{name:`${r}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},csrfToken:{name:`${t?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},pkceCodeVerifier:{name:`${r}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t,maxAge:900}},state:{name:`${r}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t,maxAge:900}},nonce:{name:`${r}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},webauthnChallenge:{name:`${r}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t,maxAge:900}}}).sessionToken.name,decode:n=eD,salt:o=a,secret:s,logger:c=console,raw:p,req:l}=e;if(!l)throw Error("Must pass `req` to JWT getToken()");let u=l.headers instanceof Headers?l.headers:new Headers(l.headers),h=new eC({name:a,options:{secure:i}},eM(u.get("cookie")??""),c).value,y=u.get("authorization");if(h||y?.split(" ")[0]!=="Bearer"||(h=decodeURIComponent(y.split(" ")[1])),!h)return null;if(p)return h;if(!s)throw new eT("Must pass `secret` if not set to JWT getToken()");try{return await n({token:h,secret:s,salt:o})}catch{return null}}async function eL(e,t,r){let i;switch(e){case"A256CBC-HS512":i=64;break;case"A256GCM":i=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await y("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,i)}e.s(["getToken",()=>eU],36296)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ccaf6db8._.js.map